---
title: "24条件のプロットの比較"

author: "Hirasawa Wakana"
date: "2025-07-11"
output: 
  html_document:
    toc: true         
    toc_depth: 3     
    toc_float: true 
abstract: 強化学習エージェントから生成された行動データに対して、フルモデルをフィッティングして、パラメータがうまく推定されているかを確認した。そして、24個のフィッティングの生成データ・traceplot・事後分布・実際の選択確率と事後予測プロットの比較を行った。
---

```{r setup, include=FALSE}
library(tidyverse)
library(gridExtra)
library(cmdstanr)
library(posterior)
library(knitr)
library(ggplot2)
library(bayesplot) 
library(stringr)
library(tools)
library(fs)
library(glue)
library(png)
library(grid)
library(purrr)
library(dplyr)


knitr::opts_chunk$set(echo = TRUE)
```

# 1.目的

## 1.1【大きい目的】

人間が社会規範に従うメカニズムを明らかにする

そのために、既存の複数の理論が提案する「規範遵守のメカニズム」が、互いにどのように異なり、どのように識別可能であるかを明らかにしたい


## 1.2【中ぐらいの目的】

フィッティング（パラメータリカバリー）を行うことで以下のことを確認する

強化学習エージェントから生成された行動データに対して、それぞれの強化学習モデルをフィッティングして、パラメータがうまく推定されているかを確認する

たとえば学習率 = 0.6、 逆温度 = 0.2という値の下で生成されたデータに、モデルをフィッティングしたとき、この2つの値が推定されないならば、モデルフィッティングがあまりうまくいかないことを意味する

## 1.3【小さい目的】

課題ごとでフィッティング結果にどのような違いがあるかを確認する。

# 2.課題設定

t0では、行動A（規範的な行動）を確率P(A)で、行動B（非規範的な行動）を確率1-P(A)で選択する

行動Aを選択すると確率T(r1| t0, A)でr1に、1-T(r2| t0, A)でr2の報酬を受け取る

行動Bを選択すると確率T(r3| t0, B)でr3に、1-T(r4| t0, B)でr4の報酬を受け取る

## 2.1 実施内容

各モデルから1つのパラメータ条件を選び、フィッティングする

フィッティング結果に対して、それぞれのモデルのパラメータにおけるtraceplotと事後分布をプロットする

フィッティング結果に対して、実際の選択確率と事後予測プロットの比較をする


# 3 プロット

## 3.1 生成データの確認

## 50人のデータと5000人のデータの比較 {.tabset .tabset-fade .tabset-pills}

### T0-7_r5-5-0-15_50agents
```{r}
knitr::include_graphics(c("figure-html1/hyouzi-1.png","figure-html1/hyouzi2-1.png"))
```

### T0-7_r5-5-0-18_50agents
```{r}
knitr::include_graphics(c("figure-html2/hyouzi-1.png","figure-html2/hyouzi2-1.png"))
```

### T0-7_r5-5-0-30_50agents
```{r}
knitr::include_graphics(c("figure-html3/hyouzi-1.png","figure-html3/hyouzi2-1.png"))
```

### T0-3_r5-5-0-45/7_50agents
```{r}
knitr::include_graphics(c("figure-html4/hyouzi-1.png","figure-html4/hyouzi2-1.png"))
```

### T0-3_r5-5-0-54/7_50agents
```{r}
knitr::include_graphics(c("figure-html5/hyouzi-1.png","figure-html5/hyouzi2-1.png"))
```

### T0-3_r5-5-0-90/7_50agents
```{r}
knitr::include_graphics(c("figure-html6/hyouzi-1.png","figure-html6/hyouzi2-1.png"))
```

### T0-7_r2-2-0-5_50agents
```{r}
knitr::include_graphics(c("figure-html7/hyouzi-1.png","figure-html7/hyouzi2-1.png"))
```

### T0-7_r2-2-0-8_50agents
```{r}
knitr::include_graphics(c("figure-html8/hyouzi-1.png","figure-html8/hyouzi2-1.png"))
```

### T0-7_r2-2-0-20_50agents
```{r}
knitr::include_graphics(c("figure-html9/hyouzi-1.png","figure-html9/hyouzi2-1.png"))
```

### T0-3_r2-2-0-15/7_50agents
```{r}
knitr::include_graphics(c("figure-html10/hyouzi-1.png","figure-html10/hyouzi2-1.png"))
```

### T0-3_r2-2-0-24/7_50agents
```{r}
knitr::include_graphics(c("figure-html11/hyouzi-1.png","figure-html11/hyouzi2-1.png"))
```

### T0-3_r2-2-0-60/7_50agents
```{r}
knitr::include_graphics(c("figure-html12/hyouzi-1.png","figure-html12/hyouzi2-1.png"))
```

### T0-9_r5-5-0-30_50agents
```{r}
knitr::include_graphics(c("figure-html13/hyouzi-1.png","figure-html13/hyouzi2-1.png"))
```

### T0-4_r5-5-0-30_50agents
```{r}
knitr::include_graphics(c("figure-html14/hyouzi-1.png","figure-html14/hyouzi2-1.png"))
```

### T0-1_r5-5-0-30_50agents
```{r}
knitr::include_graphics(c("figure-html15/hyouzi-1.png","figure-html15/hyouzi2-1.png"))
```

### T0-9_r5-5-0-15_50agents
```{r}
knitr::include_graphics(c("figure-html16/hyouzi-1.png","figure-html16/hyouzi2-1.png"))
```

### T0-4_r5-5-0-15_50agents
```{r}
knitr::include_graphics(c("figure-html17/hyouzi-1.png","figure-html17/hyouzi2-1.png"))
```

### T0-1_r5-5-0-15_50agents
```{r}
knitr::include_graphics(c("figure-html18/hyouzi-1.png","figure-html18/hyouzi2-1.png"))
```

### T0-9_r2-2-0-10_50agents
```{r}
knitr::include_graphics(c("figure-html19/hyouzi-1.png","figure-html19/hyouzi2-1.png"))
```

### T0-4_r2-2-0-10_50agents
```{r}
knitr::include_graphics(c("figure-html20/hyouzi-1.png","figure-html20/hyouzi2-1.png"))
```

### T0-1_r2-2-0-10_50agents
```{r}
knitr::include_graphics(c("figure-html21/hyouzi-1.png","figure-html21/hyouzi2-1.png"))
```

### T0-9_r2-2-0-5_50agents
```{r}
knitr::include_graphics(c("figure-html22/hyouzi-1.png","figure-html22/hyouzi2-1.png"))
```

### T0-4_r2-2-0-5_50agents
```{r}
knitr::include_graphics(c("figure-html23/hyouzi-1.png","figure-html23/hyouzi2-1.png"))
```

### T0-1_r2-2-0-5_50agents
```{r}
knitr::include_graphics(c("figure-html24/hyouzi-1.png","figure-html24/hyouzi2-1.png"))
```




## 3.2 プロットの比較

## traceplot alpha {.tabset .tabset-fade .tabset-pills}

### T0-7_r5-5-0-15_50agents
```{r}
knitr::include_graphics("figure-html1/alpha1-1.png")
```

### T0-7_r5-5-0-18_50agents
```{r}
knitr::include_graphics("figure-html2/alpha1-1.png")
```

### T0-7_r5-5-0-30_50agents
```{r}
knitr::include_graphics("figure-html3/alpha1-1.png")
```

### T0-3_r5-5-0-45/7_50agents
```{r}
knitr::include_graphics("figure-html4/alpha1-1.png")
```

### T0-3_r5-5-0-54/7_50agents
```{r}
knitr::include_graphics("figure-html5/alpha1-1.png")
```

### T0-3_r5-5-0-90/7_50agents
```{r}
knitr::include_graphics("figure-html6/alpha1-1.png")
```

### T0-7_r2-2-0-5_50agents
```{r}
knitr::include_graphics("figure-html7/alpha1-1.png")
```

### T0-7_r2-2-0-8_50agents
```{r}
knitr::include_graphics("figure-html8/alpha1-1.png")
```

### T0-7_r2-2-0-20_50agents
```{r}
knitr::include_graphics("figure-html9/alpha1-1.png")
```

### T0-3_r2-2-0-15/7_50agents
```{r}
knitr::include_graphics("figure-html10/alpha1-1.png")
```

### T0-3_r2-2-0-24/7_50agents
```{r}
knitr::include_graphics("figure-html11/alpha1-1.png")
```

### T0-3_r2-2-0-60/7_50agents
```{r}
knitr::include_graphics("figure-html12/alpha1-1.png")
```

### T0-9_r5-5-0-30_50agents
```{r}
knitr::include_graphics("figure-html13/alpha1-1.png")
```

### T0-4_r5-5-0-30_50agents
```{r}
knitr::include_graphics("figure-html14/alpha1-1.png")
```

### T0-1_r5-5-0-30_50agents
```{r}
knitr::include_graphics("figure-html15/alpha1-1.png")
```

### T0-9_r5-5-0-15_50agents
```{r}
knitr::include_graphics("figure-html16/alpha1-1.png")
```

### T0-4_r5-5-0-15_50agents
```{r}
knitr::include_graphics("figure-html17/alpha1-1.png")
```

### T0-1_r5-5-0-15_50agents
```{r}
knitr::include_graphics("figure-html18/alpha1-1.png")
```

### T0-9_r2-2-0-10_50agents
```{r}
knitr::include_graphics("figure-html19/alpha1-1.png")
```

### T0-4_r2-2-0-10_50agents
```{r}
knitr::include_graphics("figure-html20/alpha1-1.png")
```

### T0-1_r2-2-0-10_50agents
```{r}
knitr::include_graphics("figure-html21/alpha1-1.png")
```

### T0-9_r2-2-0-5_50agents
```{r}
knitr::include_graphics("figure-html22/alpha1-1.png")
```

### T0-4_r2-2-0-5_50agents
```{r}
knitr::include_graphics("figure-html23/alpha1-1.png")
```

### T0-1_r2-2-0-5_50agents
```{r}
knitr::include_graphics("figure-html24/alpha1-1.png")
```


## traceplot beta {.tabset .tabset-fade .tabset-pills}

### T0-7_r5-5-0-15_50agents
```{r}
knitr::include_graphics("figure-html1/beta1-1.png")
```

### T0-7_r5-5-0-18_50agents
```{r}
knitr::include_graphics("figure-html2/beta1-1.png")
```

### T0-7_r5-5-0-30_50agents
```{r}
knitr::include_graphics("figure-html3/beta1-1.png")
```

### T0-3_r5-5-0-45/7_50agents
```{r}
knitr::include_graphics("figure-html4/beta1-1.png")
```

### T0-3_r5-5-0-54/7_50agents
```{r}
knitr::include_graphics("figure-html5/beta1-1.png")
```

### T0-3_r5-5-0-90/7_50agents
```{r}
knitr::include_graphics("figure-html6/beta1-1.png")
```

### T0-7_r2-2-0-5_50agents
```{r}
knitr::include_graphics("figure-html7/beta1-1.png")
```

### T0-7_r2-2-0-8_50agents
```{r}
knitr::include_graphics("figure-html8/beta1-1.png")
```

### T0-7_r2-2-0-20_50agents
```{r}
knitr::include_graphics("figure-html9/beta1-1.png")
```

### T0-3_r2-2-0-15/7_50agents
```{r}
knitr::include_graphics("figure-html10/beta1-1.png")
```

### T0-3_r2-2-0-24/7_50agents
```{r}
knitr::include_graphics("figure-html11/beta1-1.png")
```

### T0-3_r2-2-0-60/7_50agents
```{r}
knitr::include_graphics("figure-html12/beta1-1.png")
```

### T0-9_r5-5-0-30_50agents
```{r}
knitr::include_graphics("figure-html13/beta1-1.png")
```

### T0-4_r5-5-0-30_50agents
```{r}
knitr::include_graphics("figure-html14/beta1-1.png")
```

### T0-1_r5-5-0-30_50agents
```{r}
knitr::include_graphics("figure-html15/beta1-1.png")
```

### T0-9_r5-5-0-15_50agents
```{r}
knitr::include_graphics("figure-html16/beta1-1.png")
```

### T0-4_r5-5-0-15_50agents
```{r}
knitr::include_graphics("figure-html17/beta1-1.png")
```

### T0-1_r5-5-0-15_50agents
```{r}
knitr::include_graphics("figure-html18/beta1-1.png")
```

### T0-9_r2-2-0-10_50agents
```{r}
knitr::include_graphics("figure-html19/beta1-1.png")
```

### T0-4_r2-2-0-10_50agents
```{r}
knitr::include_graphics("figure-html20/beta1-1.png")
```

### T0-1_r2-2-0-10_50agents
```{r}
knitr::include_graphics("figure-html21/beta1-1.png")
```

### T0-9_r2-2-0-5_50agents
```{r}
knitr::include_graphics("figure-html22/beta1-1.png")
```

### T0-4_r2-2-0-5_50agents
```{r}
knitr::include_graphics("figure-html23/beta1-1.png")
```

### T0-1_r2-2-0-5_50agents
```{r}
knitr::include_graphics("figure-html24/beta1-1.png")
```


## 事後分布 alpha {.tabset .tabset-fade .tabset-pills}

### T0-7_r5-5-0-15_50agents
```{r}
knitr::include_graphics("figure-html1/zigoalpha1-1.png")
```

### T0-7_r5-5-0-18_50agents
```{r}
knitr::include_graphics("figure-html2/zigoalpha1-1.png")
```

### T0-7_r5-5-0-30_50agents
```{r}
knitr::include_graphics("figure-html3/zigoalpha1-1.png")
```

### T0-3_r5-5-0-45/7_50agents
```{r}
knitr::include_graphics("figure-html4/zigoalpha1-1.png")
```

### T0-3_r5-5-0-54/7_50agents
```{r}
knitr::include_graphics("figure-html5/zigoalpha1-1.png")
```

### T0-3_r5-5-0-90/7_50agents
```{r}
knitr::include_graphics("figure-html6/zigoalpha1-1.png")
```

### T0-7_r2-2-0-5_50agents
```{r}
knitr::include_graphics("figure-html7/zigoalpha1-1.png")
```

### T0-7_r2-2-0-8_50agents
```{r}
knitr::include_graphics("figure-html8/zigoalpha1-1.png")
```

### T0-7_r2-2-0-20_50agents
```{r}
knitr::include_graphics("figure-html9/zigoalpha1-1.png")
```

### T0-3_r2-2-0-15/7_50agents
```{r}
knitr::include_graphics("figure-html10/zigoalpha1-1.png")
```

### T0-3_r2-2-0-24/7_50agents
```{r}
knitr::include_graphics("figure-html11/zigoalpha1-1.png")
```

### T0-3_r2-2-0-60/7_50agents
```{r}
knitr::include_graphics("figure-html12/zigoalpha1-1.png")
```

### T0-9_r5-5-0-30_50agents
```{r}
knitr::include_graphics("figure-html13/zigoalpha1-1.png")
```

### T0-4_r5-5-0-30_50agents
```{r}
knitr::include_graphics("figure-html14/zigoalpha1-1.png")
```

### T0-1_r5-5-0-30_50agents
```{r}
knitr::include_graphics("figure-html15/zigoalpha1-1.png")
```

### T0-9_r5-5-0-15_50agents
```{r}
knitr::include_graphics("figure-html16/zigoalpha1-1.png")
```

### T0-4_r5-5-0-15_50agents
```{r}
knitr::include_graphics("figure-html17/zigoalpha1-1.png")
```

### T0-1_r5-5-0-15_50agents
```{r}
knitr::include_graphics("figure-html18/zigoalpha1-1.png")
```

### T0-9_r2-2-0-10_50agents
```{r}
knitr::include_graphics("figure-html19/zigoalpha1-1.png")
```

### T0-4_r2-2-0-10_50agents
```{r}
knitr::include_graphics("figure-html20/zigoalpha1-1.png")
```

### T0-1_r2-2-0-10_50agents
```{r}
knitr::include_graphics("figure-html21/zigoalpha1-1.png")
```

### T0-9_r2-2-0-5_50agents
```{r}
knitr::include_graphics("figure-html22/zigoalpha1-1.png")
```

### T0-4_r2-2-0-5_50agents
```{r}
knitr::include_graphics("figure-html23/zigoalpha1-1.png")
```

### T0-1_r2-2-0-5_50agents
```{r}
knitr::include_graphics("figure-html24/zigoalpha1-1.png")
```

## 事後分布 beta {.tabset .tabset-fade .tabset-pills}

### T0-7_r5-5-0-15_50agents
```{r}
knitr::include_graphics("figure-html1/zigobeta1-1.png")
```

### T0-7_r5-5-0-18_50agents
```{r}
knitr::include_graphics("figure-html2/zigobeta1-1.png")
```

### T0-7_r5-5-0-30_50agents
```{r}
knitr::include_graphics("figure-html3/zigobeta1-1.png")
```

### T0-3_r5-5-0-45/7_50agents
```{r}
knitr::include_graphics("figure-html4/zigobeta1-1.png")
```

### T0-3_r5-5-0-54/7_50agents
```{r}
knitr::include_graphics("figure-html5/zigobeta1-1.png")
```

### T0-3_r5-5-0-90/7_50agents
```{r}
knitr::include_graphics("figure-html6/zigobeta1-1.png")
```

### T0-7_r2-2-0-5_50agents
```{r}
knitr::include_graphics("figure-html7/zigobeta1-1.png")
```

### T0-7_r2-2-0-8_50agents
```{r}
knitr::include_graphics("figure-html8/zigobeta1-1.png")
```

### T0-7_r2-2-0-20_50agents
```{r}
knitr::include_graphics("figure-html9/zigobeta1-1.png")
```

### T0-3_r2-2-0-15/7_50agents
```{r}
knitr::include_graphics("figure-html10/zigobeta1-1.png")
```

### T0-3_r2-2-0-24/7_50agents
```{r}
knitr::include_graphics("figure-html11/zigobeta1-1.png")
```

### T0-3_r2-2-0-60/7_50agents
```{r}
knitr::include_graphics("figure-html12/zigobeta1-1.png")
```

### T0-9_r5-5-0-30_50agents
```{r}
knitr::include_graphics("figure-html13/zigobeta1-1.png")
```

### T0-4_r5-5-0-30_50agents
```{r}
knitr::include_graphics("figure-html14/zigobeta1-1.png")
```

### T0-1_r5-5-0-30_50agents
```{r}
knitr::include_graphics("figure-html15/zigobeta1-1.png")
```

### T0-9_r5-5-0-15_50agents
```{r}
knitr::include_graphics("figure-html16/zigobeta1-1.png")
```

### T0-4_r5-5-0-15_50agents
```{r}
knitr::include_graphics("figure-html17/zigobeta1-1.png")
```

### T0-1_r5-5-0-15_50agents
```{r}
knitr::include_graphics("figure-html18/zigobeta1-1.png")
```

### T0-9_r2-2-0-10_50agents
```{r}
knitr::include_graphics("figure-html19/zigobeta1-1.png")
```

### T0-4_r2-2-0-10_50agents
```{r}
knitr::include_graphics("figure-html20/zigobeta1-1.png")
```

### T0-1_r2-2-0-10_50agents
```{r}
knitr::include_graphics("figure-html21/zigobeta1-1.png")
```

### T0-9_r2-2-0-5_50agents
```{r}
knitr::include_graphics("figure-html22/zigobeta1-1.png")
```

### T0-4_r2-2-0-5_50agents
```{r}
knitr::include_graphics("figure-html23/zigobeta1-1.png")
```

### T0-1_r2-2-0-5_50agents
```{r}
knitr::include_graphics("figure-html24/zigobeta1-1.png")
```



## 実際の選択確率と事後予測プロットの比較 {.tabset .tabset-fade .tabset-pills}

### T0-7_r5-5-0-15_50agents
```{r}
knitr::include_graphics("figure-html1/compare_stan1-1.png")
```

### T0-7_r5-5-0-18_50agents
```{r}
knitr::include_graphics("figure-html2/compare_stan1-1.png")
```

### T0-7_r5-5-0-30_50agents
```{r}
knitr::include_graphics("figure-html3/compare_stan1-1.png")
```

### T0-3_r5-5-0-45/7_50agents
```{r}
knitr::include_graphics("figure-html4/compare_stan1-1.png")
```

### T0-3_r5-5-0-54/7_50agents
```{r}
knitr::include_graphics("figure-html5/compare_stan1-1.png")
```

### T0-3_r5-5-0-90/7_50agents
```{r}
knitr::include_graphics("figure-html6/compare_stan1-1.png")
```

### T0-7_r2-2-0-5_50agents
```{r}
knitr::include_graphics("figure-html7/compare_stan1-1.png")
```

### T0-7_r2-2-0-8_50agents
```{r}
knitr::include_graphics("figure-html8/compare_stan1-1.png")
```

### T0-7_r2-2-0-20_50agents
```{r}
knitr::include_graphics("figure-html9/compare_stan1-1.png")
```

### T0-3_r2-2-0-15/7_50agents
```{r}
knitr::include_graphics("figure-html10/compare_stan1-1.png")
```

### T0-3_r2-2-0-24/7_50agents
```{r}
knitr::include_graphics("figure-html11/compare_stan1-1.png")
```

### T0-3_r2-2-0-60/7_50agents
```{r}
knitr::include_graphics("figure-html12/compare_stan1-1.png")
```

### T0-9_r5-5-0-30_50agents
```{r}
knitr::include_graphics("figure-html13/compare_stan1-1.png")
```

### T0-4_r5-5-0-30_50agents
```{r}
knitr::include_graphics("figure-html14/compare_stan1-1.png")
```

### T0-1_r5-5-0-30_50agents
```{r}
knitr::include_graphics("figure-html15/compare_stan1-1.png")
```

### T0-9_r5-5-0-15_50agents
```{r}
knitr::include_graphics("figure-html16/compare_stan1-1.png")
```

### T0-4_r5-5-0-15_50agents
```{r}
knitr::include_graphics("figure-html17/compare_stan1-1.png")
```

### T0-1_r5-5-0-15_50agents
```{r}
knitr::include_graphics("figure-html18/compare_stan1-1.png")
```

### T0-9_r2-2-0-10_50agents
```{r}
knitr::include_graphics("figure-html19/compare_stan1-1.png")
```

### T0-4_r2-2-0-10_50agents
```{r}
knitr::include_graphics("figure-html20/compare_stan1-1.png")
```

### T0-1_r2-2-0-10_50agents
```{r}
knitr::include_graphics("figure-html21/compare_stan1-1.png")
```

### T0-9_r2-2-0-5_50agents
```{r}
knitr::include_graphics("figure-html22/compare_stan1-1.png")
```

### T0-4_r2-2-0-5_50agents
```{r}
knitr::include_graphics("figure-html23/compare_stan1-1.png")
```

### T0-1_r2-2-0-5_50agents
```{r}
knitr::include_graphics("figure-html24/compare_stan1-1.png")
```

